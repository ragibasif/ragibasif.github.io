---
import { getCollection } from "astro:content";
import Layout from "@layouts/Layout.astro";
import FormatDate from "@components/FormatDate.astro";
import Container from "@components/Container.astro";
import { BLOG } from "@consts";

const posts = (await getCollection("blog")).sort(
  (a, b) => b.data.date.valueOf() - a.data.date.valueOf()
);
---

<Layout title={BLOG.TITLE} description={BLOG.DESCRIPTION}>
  <Container class="post-title">
    <h1>Blog</h1>
    <ul>
      {
        posts.map((post) => (
          <li>
            <a href={`/blog/${post.id}/`}>
              <div class="post-item">
                <h4 class="title">{post.data.title}</h4>
                <p class="date">
                  <FormatDate date={post.data.date} />
                </p>
              </div>
            </a>
          </li>
        ))
      }
    </ul>
  </Container>
</Layout>

<style>
  .post-list {
    margin-top: 1rem;
  }

  ul {
    padding: 0;
    margin: 0;
    list-style-type: none;
    display: flex;
    flex-direction: column;
    gap: 0;
  }

  a {
    color: var(--text);
    display: block;
    text-decoration: none;
    transition: opacity 0.15s ease-out;
  }

  @media (hover: hover) and (pointer: fine) {
    ul:hover a {
      opacity: 0.4;
    }

    ul:hover a:hover {
      opacity: 1;
    }

    ul:hover a:hover .date {
      opacity: 1;
    }
  }

  .post-item {
    height: 2.75rem;
    display: flex;
    justify-content: space-between;
    align-items: center;
    gap: 0.75rem;
  }

  .post-item.date-left {
    justify-content: flex-start;
  }

  .post-item.date-left .title {
    flex: 1 1 auto;
    min-width: 0;
  }

  .post-item.date-left .date {
    margin-right: 0.75rem;
  }

  .title {
    margin: 0;
    flex-shrink: 1;
    min-width: 0;
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
  }

  .date {
    margin: 0;
    opacity: 0.75;
    flex-shrink: 0;
    white-space: nowrap;
  }
</style>
